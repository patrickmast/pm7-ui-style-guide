// Refactor: Extracted the "Demo" tab content from example-menu.tsx to this file as ExampleMenuDemo.
import React from 'react';
import { PM7Menu, PM7MenuIcon } from '../src/components/menu';
import { HomeIcon, SettingsIcon, UserIcon, MoonIcon, SunIcon, LanguagesIcon } from 'lucide-react';

interface Descriptions {
  [key: string]: {
    basicMenu: string;
    title: string;
    features: string;
    multiLanguage: string;
    themeSwitching: string;
    submenu: string;
    icons: string;
    separators: string;
    checkboxes: string;
    menuAlignment: string;
    startAlignment: string;
    centerAlignment: string;
    endAlignment: string;
    customIconColor: string;
    iconColorDesc: string;
    prop: string;
    exampleUses: string;
    primaryBlue: string;
    yellow: string;
    color: string;
  };
}

type ThemeType = 'light' | 'dark';
type LanguageType = 'en' | 'es' | 'fr' | 'de' | 'nl' | 'nl-be' | 'zh';

interface ExtendedMenuItemType {
  id: string;
  label: string;
  [key: string]: any;
  icon?: React.ReactNode;
  checked?: boolean;
  type?: string;
  submenuItems?: ExtendedMenuItemType[];
  onClick?: () => void;
  onChange?: () => void;
}

const ExampleMenuDemo = ({ theme }: { theme: ThemeType }) => {
  const [selectedLanguage, setSelectedLanguage] = React.useState<LanguageType>(() => {
    if (typeof window !== 'undefined') {
      const savedLanguage = localStorage.getItem('pm7-language-demo');
      if (savedLanguage && ['en', 'es', 'fr', 'de', 'nl', 'nl-be', 'zh'].includes(savedLanguage)) {
        return savedLanguage as LanguageType;
      }
    }
    return 'en';
  });

  const handleLanguageChange = (lang: LanguageType) => {
    setSelectedLanguage(lang);
    if (typeof window !== 'undefined') {
      localStorage.setItem('pm7-language-demo', lang);
    }
  };

  const getLabel = (item: ExtendedMenuItemType): string => {
    const langKey = `label-${selectedLanguage}`;
    return item[langKey] || item.label || '';
  };

  // Add a function to get the flag emoji for the selected language
  const getFlagIcon = (lang: LanguageType) => {
    switch (lang) {
      case 'en': return 'üá¨üáß'; // UK flag for English
      case 'es': return 'üá™üá∏'; // Spain
      case 'fr': return 'üá´üá∑'; // France
      case 'de': return 'üá©üá™'; // Germany
      case 'nl': return 'üá≥üá±'; // Netherlands
      case 'nl-be': return 'üáßüá™'; // Belgium
      case 'zh': return 'üá®üá≥'; // China
      default: return 'üè≥Ô∏è';
    }
  };

  // Memoized icons
  const homeIcon = React.useMemo(() => <HomeIcon size={16} className="menu-item-svg-icon" />, []);
  const profileIcon = React.useMemo(() => <UserIcon size={16} className="menu-item-svg-icon" />, []);
  const settingsIcon = React.useMemo(() => <SettingsIcon size={16} className="menu-item-svg-icon" />, []);
  const flagIcon = React.useMemo(() => <span style={{ fontSize: 16, marginRight: 4 }}>{getFlagIcon(selectedLanguage)}</span>, [selectedLanguage]);
  const themeIcon = React.useMemo(() => theme === 'dark' ? <MoonIcon size={16} /> : <SunIcon size={16} />, [theme]);

  // Memoize menuItems array
  const menuItems = React.useMemo(() => [
    {
      id: 'home',
      label: 'Home',
      'label-en': 'Home',
      'label-es': 'Inicio',
      'label-fr': 'Accueil',
      'label-de': 'Startseite',
      'label-nl': 'Home',
      'label-nl-be': 'Home',
      'label-zh': 'È¶ñÈ°µ',
      onClick: () => console.log('Home selected'),
      icon: homeIcon
    },
    {
      id: 'profile',
      label: 'Profile',
      'label-en': 'Profile',
      'label-es': 'Perfil',
      'label-fr': 'Profil',
      'label-de': 'Profil',
      'label-nl': 'Profiel',
      'label-nl-be': 'Profiel',
      'label-zh': '‰∏™‰∫∫ËµÑÊñô',
      onClick: () => console.log('Profile selected'),
      icon: profileIcon
    },
    {
      id: 'settings',
      label: 'Settings',
      'label-en': 'Settings',
      'label-es': 'Ajustes',
      'label-fr': 'Param√®tres',
      'label-de': 'Einstellungen',
      'label-nl': 'Instellingen',
      'label-nl-be': 'Instellingen',
      'label-zh': 'ËÆæÁΩÆ',
      onClick: () => console.log('Settings selected'),
      icon: settingsIcon
    },
    {
      id: 'separator1',
      label: '',
      type: 'separator'
    },
    {
      id: 'language',
      label: 'Language',
      'label-en': 'Language',
      'label-es': 'Idioma',
      'label-fr': 'Langue',
      'label-de': 'Sprache',
      'label-nl': 'Taal',
      'label-nl-be': 'Taal',
      'label-zh': 'ËØ≠Ë®Ä',
      type: 'submenu',
      icon: flagIcon,
      submenuItems: [
        { id: 'en', label: 'English', type: 'check', checked: selectedLanguage === 'en', onClick: () => handleLanguageChange('en') },
        { id: 'es', label: 'Espa√±ol', type: 'check', checked: selectedLanguage === 'es', onClick: () => handleLanguageChange('es') },
        { id: 'fr', label: 'Fran√ßais', type: 'check', checked: selectedLanguage === 'fr', onClick: () => handleLanguageChange('fr') },
        { id: 'de', label: 'Deutsch', type: 'check', checked: selectedLanguage === 'de', onClick: () => handleLanguageChange('de') },
        { id: 'nl', label: 'Nederlands', type: 'check', checked: selectedLanguage === 'nl', onClick: () => handleLanguageChange('nl') },
        { id: 'nl-be', label: 'Nederlands (Belgi√´)', type: 'check', checked: selectedLanguage === 'nl-be', onClick: () => handleLanguageChange('nl-be') },
        { id: 'zh', label: '‰∏≠Êñá', type: 'check', checked: selectedLanguage === 'zh', onClick: () => handleLanguageChange('zh') }
      ]
    },
    {
      id: 'theme',
      label: `Theme: ${theme === 'dark' ? 'Dark' : 'Light'}`,
      'label-en': `Theme: ${theme === 'dark' ? 'Dark' : 'Light'}`,
      'label-es': `Tema: ${theme === 'dark' ? 'Oscuro' : 'Claro'}`,
      'label-fr': `Th√®me: ${theme === 'dark' ? 'Sombre' : 'Clair'}`,
      'label-de': `Thema: ${theme === 'dark' ? 'Dunkel' : 'Hell'}`,
      'label-nl': `Thema: ${theme === 'dark' ? 'Donker' : 'Licht'}`,
      'label-nl-be': `Thema: ${theme === 'dark' ? 'Donker' : 'Licht'}`,
      'label-zh': `‰∏ªÈ¢ò: ${theme === 'dark' ? 'Ê∑±Ëâ≤' : 'ÊµÖËâ≤'}`,
      type: 'switch',
      icon: themeIcon,
      checked: theme === 'dark',
      onChange: () => {
        // Theme is now controlled by the App component
        // This is just for display in the menu example
        console.log('Theme toggle clicked in menu example')
      }
    }
  ], [homeIcon, profileIcon, settingsIcon, flagIcon, themeIcon, selectedLanguage, theme]);

  const descriptions: Descriptions = {
    en: {
      basicMenu: 'Basic Menu',
      title: 'A standard menu with hamburger icon and custom menu items.',
      features: 'Features:',
      multiLanguage: 'Multi-language support',
      themeSwitching: 'Theme switching',
      submenu: 'Submenu support',
      icons: 'Icons',
      separators: 'Separators',
      checkboxes: 'Checkboxes and switches',
      menuAlignment: 'Menu Alignment',
      startAlignment: 'Start Alignment',
      centerAlignment: 'Center Alignment',
      endAlignment: 'End Alignment',
      customIconColor: 'Custom Icon Color',
      iconColorDesc: 'The menu icon color can be customized using the',
      prop: 'prop.',
      exampleUses: 'This example uses',
      primaryBlue: 'the PM7 primary blue',
      yellow: 'yellow',
      color: 'color:',
    },
    es: {
      basicMenu: 'Men√∫ B√°sico',
      title: 'Un men√∫ est√°ndar con icono de hamburguesa y elementos de men√∫ personalizados.',
      features: 'Caracter√≠sticas:',
      multiLanguage: 'Soporte multiling√ºe',
      themeSwitching: 'Cambio de tema',
      submenu: 'Soporte de submen√∫',
      icons: 'Iconos',
      separators: 'Separadores',
      checkboxes: 'Casillas de verificaci√≥n e interruptores',
      menuAlignment: 'Alineaci√≥n del Men√∫',
      startAlignment: 'Alineaci√≥n Inicial',
      centerAlignment: 'Alineaci√≥n Central',
      endAlignment: 'Alineaci√≥n Final',
      customIconColor: 'Color de Icono Personalizado',
      iconColorDesc: 'El color del icono del men√∫ se puede personalizar usando la',
      prop: 'propiedad.',
      exampleUses: 'Este ejemplo usa',
      primaryBlue: 'el azul primario de PM7',
      yellow: 'amarillo',
      color: 'color:',
    },
    fr: {
      basicMenu: 'Menu de Base',
      title: 'Un menu standard avec ic√¥ne hamburger et √©l√©ments de menu personnalis√©s.',
      features: 'Fonctionnalit√©s:',
      multiLanguage: 'Support multilingue',
      themeSwitching: 'Changement de th√®me',
      submenu: 'Support de sous-menu',
      icons: 'Ic√¥nes',
      separators: 'S√©parateurs',
      checkboxes: 'Cases √† cocher et interrupteurs',
      menuAlignment: 'Alignement du Menu',
      startAlignment: 'Alignement au D√©but',
      centerAlignment: 'Alignement au Centre',
      endAlignment: 'Alignement √† la Fin',
      customIconColor: 'Couleur d\'Ic√¥ne Personnalis√©e',
      iconColorDesc: 'La couleur de l\'ic√¥ne du menu peut √™tre personnalis√©e √† l\'aide de la',
      prop: 'propri√©t√©.',
      exampleUses: 'Cet exemple utilise',
      primaryBlue: 'le bleu primaire PM7',
      yellow: 'jaune',
      color: 'couleur:',
    },
    de: {
      basicMenu: 'Basis-Men√º',
      title: 'Ein Standard-Men√º mit Hamburger-Symbol und benutzerdefinierten Men√ºelementen.',
      features: 'Funktionen:',
      multiLanguage: 'Mehrsprachige Unterst√ºtzung',
      themeSwitching: 'Themenwechsel',
      submenu: 'Untermen√º-Unterst√ºtzung',
      icons: 'Symbole',
      separators: 'Trennlinien',
      checkboxes: 'Kontrollk√§stchen und Schalter',
      menuAlignment: 'Men√º-Ausrichtung',
      startAlignment: 'Ausrichtung am Anfang',
      centerAlignment: 'Zentrale Ausrichtung',
      endAlignment: 'Ausrichtung am Ende',
      customIconColor: 'Benutzerdefinierte Symbolfarbe',
      iconColorDesc: 'Die Farbe des Men√ºsymbols kann mit der',
      prop: 'Eigenschaft angepasst werden.',
      exampleUses: 'Dieses Beispiel verwendet',
      primaryBlue: 'das PM7-Prim√§rblau',
      yellow: 'gelb',
      color: 'Farbe:',
    },
    nl: {
      basicMenu: 'Basis Menu',
      title: 'Een standaard menu met hamburger-pictogram en aangepaste menu-items.',
      features: 'Functies:',
      multiLanguage: 'Meertalige ondersteuning',
      themeSwitching: 'Thema wisselen',
      submenu: 'Submenu-ondersteuning',
      icons: 'Pictogrammen',
      separators: 'Scheidingslijnen',
      checkboxes: 'Selectievakjes en schakelaars',
      menuAlignment: 'Menu Uitlijning',
      startAlignment: 'Begin Uitlijning',
      centerAlignment: 'Midden Uitlijning',
      endAlignment: 'Einde Uitlijning',
      customIconColor: 'Aangepaste Pictogramkleur',
      iconColorDesc: 'De kleur van het menupictogram kan worden aangepast met de',
      prop: 'eigenschap.',
      exampleUses: 'Dit voorbeeld gebruikt',
      primaryBlue: 'de PM7 primaire blauwe',
      yellow: 'gele',
      color: 'kleur:',
    },
    'nl-be': {
      basicMenu: 'Basis Menu',
      title: 'Een standaard menu met hamburger-pictogram en aangepaste menu-items.',
      features: 'Functies:',
      multiLanguage: 'Meertalige ondersteuning',
      themeSwitching: 'Thema wisselen',
      submenu: 'Submenu-ondersteuning',
      icons: 'Pictogrammen',
      separators: 'Scheidingslijnen',
      checkboxes: 'Selectievakjes en schakelaars',
      menuAlignment: 'Menu Uitlijning',
      startAlignment: 'Begin Uitlijning',
      centerAlignment: 'Midden Uitlijning',
      endAlignment: 'Einde Uitlijning',
      customIconColor: 'Aangepaste Pictogramkleur',
      iconColorDesc: 'De kleur van het menupictogram kan worden aangepast met de',
      prop: 'eigenschap.',
      exampleUses: 'Dit voorbeeld gebruikt',
      primaryBlue: 'de PM7 primaire blauwe',
      yellow: 'gele',
      color: 'kleur:',
    },
    zh: {
      basicMenu: 'Âü∫Êú¨ËèúÂçï',
      title: 'Â∏¶ÊúâÊ±âÂ†°ÂõæÊ†áÂíåËá™ÂÆö‰πâËèúÂçïÈ°πÁöÑÊ†áÂáÜËèúÂçï„ÄÇ',
      features: 'ÂäüËÉΩÔºö',
      multiLanguage: 'Â§öËØ≠Ë®ÄÊîØÊåÅ',
      themeSwitching: '‰∏ªÈ¢òÂàáÊç¢',
      submenu: 'Â≠êËèúÂçïÊîØÊåÅ',
      icons: 'ÂõæÊ†á',
      separators: 'ÂàÜÈöîÁ¨¶',
      checkboxes: 'Â§çÈÄâÊ°ÜÂíåÂºÄÂÖ≥',
      menuAlignment: 'ËèúÂçïÂØπÈΩê',
      startAlignment: 'ÂºÄÂßãÂØπÈΩê',
      centerAlignment: 'Â±Ö‰∏≠ÂØπÈΩê',
      endAlignment: 'ÁªìÊùüÂØπÈΩê',
      customIconColor: 'Ëá™ÂÆö‰πâÂõæÊ†áÈ¢úËâ≤',
      iconColorDesc: 'ËèúÂçïÂõæÊ†áÈ¢úËâ≤ÂèØ‰ª•‰ΩøÁî®',
      prop: 'Â±ûÊÄßËøõË°åËá™ÂÆö‰πâ„ÄÇ',
      exampleUses: 'Ê≠§Á§∫‰æã‰ΩøÁî®',
      primaryBlue: 'PM7‰∏ªË¶ÅËìùËâ≤',
      yellow: 'ÈªÑËâ≤',
      color: 'È¢úËâ≤Ôºö',
    },
  };
  const getDescription = (key: keyof typeof descriptions['en']) => {
    return descriptions[selectedLanguage]?.[key] || descriptions['en'][key] || key;
  };
  return (
    <div className="p-6">
      <div className="mb-8">
        <h3 className="text-xl font-semibold mb-3">{getDescription('basicMenu')}</h3>
        <div className="flex items-start gap-4">
          <PM7Menu
            menuItems={menuItems.map((item: any) => ({
              ...item,
              label: getLabel(item),
              submenuItems: item.submenuItems?.map((subItem: any) => ({
                ...subItem,
                label: getLabel(subItem)
              }))
            }))}
            theme={theme}
          />
          <div className="ml-4">
            <p>{getDescription('title')}</p>
            <p className="mt-2">{getDescription('features')}</p>
            <ul className="list-disc ml-5 mt-1">
              <li>{getDescription('multiLanguage')}</li>
              <li>{getDescription('themeSwitching')}</li>
              <li>{getDescription('submenu')}</li>
              <li>{getDescription('icons')}</li>
              <li>{getDescription('separators')}</li>
              <li>{getDescription('checkboxes')}</li>
            </ul>
          </div>
        </div>
      </div>
      <hr className="border-t border-gray-300 dark:border-gray-600 my-6" />
      <div className="mb-8">
        <h3 className="text-xl font-semibold mb-3">{getDescription('menuAlignment')}</h3>
        <div className="flex flex-wrap gap-8">
          <div className="flex flex-col items-start">
            <p className="mb-2">{getDescription('startAlignment')}</p>
            <PM7Menu
              menuItems={menuItems.slice(0, 3).map((item: any) => ({
                ...item,
                label: getLabel(item),
                submenuItems: item.submenuItems?.map((subItem: any) => ({
                  ...subItem,
                  label: getLabel(subItem)
                }))
              }))}
              theme={theme}
              menuAlignment="start"
            />
          </div>
          <div className="flex flex-col items-start">
            <p className="mb-2">{getDescription('centerAlignment')}</p>
            <PM7Menu
              menuItems={menuItems.slice(0, 3).map((item: any) => ({
                ...item,
                label: getLabel(item),
                submenuItems: item.submenuItems?.map((subItem: any) => ({
                  ...subItem,
                  label: getLabel(subItem)
                }))
              }))}
              theme={theme}
              menuAlignment="center"
            />
          </div>
          <div className="flex flex-col items-start">
            <p className="mb-2">{getDescription('endAlignment')}</p>
            <PM7Menu
              menuItems={menuItems.slice(0, 3).map((item: any) => ({
                ...item,
                label: getLabel(item),
                submenuItems: item.submenuItems?.map((subItem: any) => ({
                  ...subItem,
                  label: getLabel(subItem)
                }))
              }))}
              theme={theme}
              menuAlignment="end"
            />
          </div>
        </div>
      </div>
      <hr className="border-t border-gray-300 dark:border-gray-600 my-6" />
      <div className="mb-8">
        <h3 className="text-xl font-semibold mb-3">{getDescription('customIconColor')}</h3>
        <div className="flex items-start gap-4">
          <PM7Menu
            menuItems={menuItems.slice(0, 3).map((item: any) => ({
              ...item,
              label: getLabel(item),
              submenuItems: item.submenuItems?.map((subItem: any) => ({
                ...subItem,
                label: getLabel(subItem)
              }))
            }))}
            theme={theme}
            menuIconColorLight={'#1C86EF'} // PM7 Blue
            menuIconColorDark={'#FFDD00'} // Yellow
          />
          <div className="ml-4">
            <p>{getDescription('iconColorDesc')} <code>menuIconColor</code> {getDescription('prop')}</p>
            <p className="mt-2">{getDescription('exampleUses')} {theme === 'dark' ? getDescription('yellow') : getDescription('primaryBlue')} {getDescription('color')} <code>{theme === 'dark' ? '#FFDD00' : '#1C86EF'}</code></p>
          </div>
        </div>
      </div>
    </div>
  );
};

export default ExampleMenuDemo;
